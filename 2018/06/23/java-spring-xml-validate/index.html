<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    
    <title>【Spring源码】（四）XML验证模式 | Peachey Blog</title>
    
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    
        <meta name="keywords" content="Spring" />
    
    <meta name="description" content="说到xml的验证模式，那就要说下关于xml的模式定义，即DTD(Document Type Defination)和XSD（XML Schema Defination），DTD是文档类型定义，XSD是XML模式定义，XSD相较DTD的优势如下：I. DTD不遵守XML语法，但是XSD是基于XML语法的II. DTD的数据类型有限，但是XSD大大扩充了数据类型III. DTD不可扩展，但是XSD">
<meta name="keywords" content="Spring">
<meta property="og:type" content="article">
<meta property="og:title" content="【Spring源码】（四）XML验证模式">
<meta property="og:url" content="peachey.blog/2018/06/23/java-spring-xml-validate/index.html">
<meta property="og:site_name" content="Peachey Blog">
<meta property="og:description" content="说到xml的验证模式，那就要说下关于xml的模式定义，即DTD(Document Type Defination)和XSD（XML Schema Defination），DTD是文档类型定义，XSD是XML模式定义，XSD相较DTD的优势如下：I. DTD不遵守XML语法，但是XSD是基于XML语法的II. DTD的数据类型有限，但是XSD大大扩充了数据类型III. DTD不可扩展，但是XSD">
<meta property="og:locale" content="zh-CN">
<meta property="og:image" content="/img/java/spring.jpeg">
<meta property="og:updated_time" content="2021-04-02T16:10:54.322Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="【Spring源码】（四）XML验证模式">
<meta name="twitter:description" content="说到xml的验证模式，那就要说下关于xml的模式定义，即DTD(Document Type Defination)和XSD（XML Schema Defination），DTD是文档类型定义，XSD是XML模式定义，XSD相较DTD的优势如下：I. DTD不遵守XML语法，但是XSD是基于XML语法的II. DTD的数据类型有限，但是XSD大大扩充了数据类型III. DTD不可扩展，但是XSD">
<meta name="twitter:image" content="/img/java/spring.jpeg">
    

    
        <link rel="alternate" href="/" title="Peachey Blog" type="application/atom+xml" />
    

    
        <link rel="icon" href="/css/images/favicon.ico" />
    

    <link rel="stylesheet" href="/libs/font-awesome/css/font-awesome.min.css">
    <link rel="stylesheet" href="/libs/titillium-web/styles.css">
    <link rel="stylesheet" href="/libs/source-code-pro/styles.css">

    <link rel="stylesheet" href="/css/style.css">

    <script src="/libs/jquery/2.0.3/jquery.min.js"></script>
    
    
        <link rel="stylesheet" href="/libs/lightgallery/css/lightgallery.min.css">
    
    
        <link rel="stylesheet" href="/libs/justified-gallery/justifiedGallery.min.css">
    
    
    


</head>

<body>
    <div id="wrap">
        <header id="header">
    <div id="header-outer" class="outer">
        <div class="container">
            <div class="container-inner">
                <div id="header-title">
                    <h1 class="logo-wrap">
                        <a href="/" class="logo"></a>
                    </h1>
                    
                        <h2 class="subtitle-wrap">
                            <p class="subtitle">Never Give Up</p>
                        </h2>
                    
                </div>
                <div id="header-inner" class="nav-container">
                    <a id="main-nav-toggle" class="nav-icon fa fa-bars"></a>
                    <div class="nav-container-inner">
                        <ul id="main-nav">
                            
                                <li class="main-nav-list-item" >
                                    <a class="main-nav-list-link" href="/">主页</a>
                                </li>
                            
                                        <ul class="main-nav-list"><li class="main-nav-list-item"><a class="main-nav-list-link" href="/categories/技术/">技术</a></li><li class="main-nav-list-item"><a class="main-nav-list-link" href="/categories/算法/">算法</a></li></ul>
                                    
                                <li class="main-nav-list-item" >
                                    <a class="main-nav-list-link" href="/about/index.html">关于</a>
                                </li>
                            
                        </ul>
                        <nav id="sub-nav">
                            <div id="search-form-wrap">

    <form class="search-form">
        <input type="text" class="ins-search-input search-form-input" placeholder="搜索" />
        <button type="submit" class="search-form-submit"></button>
    </form>
    <div class="ins-search">
    <div class="ins-search-mask"></div>
    <div class="ins-search-container">
        <div class="ins-input-wrapper">
            <input type="text" class="ins-search-input" placeholder="想要查找什么..." />
            <span class="ins-close ins-selectable"><i class="fa fa-times-circle"></i></span>
        </div>
        <div class="ins-section-wrapper">
            <div class="ins-section-container"></div>
        </div>
    </div>
</div>
<script>
(function (window) {
    var INSIGHT_CONFIG = {
        TRANSLATION: {
            POSTS: '文章',
            PAGES: '页面',
            CATEGORIES: '分类',
            TAGS: '标签',
            UNTITLED: '(未命名)',
        },
        ROOT_URL: '/',
        CONTENT_URL: '/content.json',
    };
    window.INSIGHT_CONFIG = INSIGHT_CONFIG;
})(window);
</script>
<script src="/js/insight.js"></script>

</div>
                        </nav>
                    </div>
                </div>
            </div>
        </div>
    </div>
</header>
        <div class="container">
            <div class="main-body container-inner">
                <div class="main-body-inner">
                    <section id="main">
                        <div class="main-body-header">
    <h1 class="header">
    
    <a class="page-title-link" href="/categories/技术/">技术</a>
    </h1>
</div>
                        <div class="main-body-content">
                            <article id="post-java-spring-xml-validate" class="article article-single article-type-post" itemscope itemprop="blogPost">
    <div class="article-inner">
        
            <header class="article-header">
                
    
        <h1 class="article-title" itemprop="name">
        【Spring源码】（四）XML验证模式
        </h1>
    

            </header>
        
        
            <div class="article-meta">
                
    <div class="article-date">
        <a href="/2018/06/23/java-spring-xml-validate/" class="article-date">
            <time datetime="2018-06-23T08:39:34.000Z" itemprop="datePublished">2018-06-23</time>
        </a>
    </div>

                
    <div class="article-tag">
        <i class="fa fa-tag"></i>
        <a class="tag-link" href="/tags/Spring/">Spring</a>
    </div>

            </div>
        
        
        <div class="article-entry" itemprop="articleBody">
            <p><img src="/img/java/spring.jpeg" alt=""></p>
<blockquote>
<p>说到xml的验证模式，那就要说下关于xml的模式定义，即DTD(Document Type Defination)和XSD（XML Schema Defination），DTD是文档类型定义，XSD是XML模式定义，XSD相较DTD的优势如下：<br>I. DTD不遵守XML语法，但是XSD是基于XML语法的<br>II. DTD的数据类型有限，但是XSD大大扩充了数据类型<br>III. DTD不可扩展，但是XSD可以自定义数据类型<br>IIII. DTD不支持命名空间，但是XSD支持命名空间、元素继承以及属性组等</p>
</blockquote>
<h2 id="目录"><a href="#目录" class="headerlink" title="目录"></a>目录</h2><ol>
<li><p><a href="#1">DTD语法</a><br>1.1 <a href="#1.1">DTD分类</a><br>1.1.1 <a href="#1.1.1">内部DTD</a><br>1.1.2 <a href="#1.1.2">外部DTD</a><br>1.1.3 <a href="#1.1.3">内外结合的DTD</a><br>1.2 <a href="#1.2">ELEMENT语法</a><br>1.2.1 <a href="#1.2.1">元素定义</a><br>1.2.2 <a href="#1.2.2">元素类型</a><br>1.2.3 <a href="#1.2.3">属性语法</a><br>1.2.4 <a href="#1.2.4">属性类型</a><br>1.2.5 <a href="#1.2.5">实体</a></p>
</li>
<li><p><a href="#2">XSD语法</a><br>2.1 <a href="#2.1">Schema根元素语法</a><br>2.2 <a href="#2.2">基本数据类型</a><br>2.3 <a href="#2.3">数据约束</a><br>2.4 <a href="#2.4">元素</a><br>2.5 <a href="#2.5">默认值和固定值</a><br>2.6 <a href="#2.6">组合器</a><br>2.7 <a href="#2.7">引用和替代</a><br>2.8 <a href="#2.8">简单类型</a><br>2.9 <a href="#2.9">复杂类型</a><br>2.11 <a href="#2.11">分组和属性</a><br>2.12 <a href="#2.12">内容模型</a></p>
</li>
<li><p><a href="#3">Spring XML验证</a></p>
</li>
<li><a href="#4">参考</a></li>
</ol>
<p><span id="1"></span></p>
<h3 id="DTD语法"><a href="#DTD语法" class="headerlink" title="DTD语法"></a>DTD语法</h3><p><span id="1.1"></span></p>
<h4 id="DTD分类"><a href="#DTD分类" class="headerlink" title="DTD分类"></a>DTD分类</h4><p><span id="1.1.1"></span></p>
<h5 id="内部DTD"><a href="#内部DTD" class="headerlink" title="内部DTD"></a>内部DTD</h5><p>也就是说xml文件种即包含xml定义，又包含DTD定义，基本格式如下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;!DOCTYPE 根元素 [定义内容]&gt;</span><br></pre></td></tr></table></figure>
<p>示例如下：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version="1.0"?&gt;</span><br><span class="line"><span class="meta">&lt;!DOCTYPE poem [</span></span><br><span class="line"><span class="meta">	&lt;!ELEMENT poem (author,title,content)&gt;</span></span><br><span class="line"><span class="meta">	&lt;!ELEMENT author (#PCDATA)&gt;</span></span><br><span class="line"><span class="meta">	&lt;!ELEMENT title (#PCDATA)&gt;</span></span><br><span class="line"><span class="meta">	&lt;!ELEMENT content (#PCDATA)&gt;</span></span><br><span class="line"><span class="meta">]&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">poem</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">author</span>&gt;</span>作者<span class="tag">&lt;/<span class="name">author</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">title</span>&gt;</span>题目<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">content</span>&gt;</span>内容<span class="tag">&lt;/<span class="name">content</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">poem</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p><span id="1.1.2"></span></p>
<h5 id="外部DTD"><a href="#外部DTD" class="headerlink" title="外部DTD"></a>外部DTD</h5><p>外部DTD文档，相当于DTD的定义和xml定义是在不同的文件中的，需要在xml文件中引入该DTD文件，格式如下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;!DOCTYPE 根元素 SYSTEM &quot;DTD文件路径&quot;&gt;</span><br></pre></td></tr></table></figure>
<p>示例如下：<br>DTD文件内容：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&lt;!DOCTYPE poem [</span><br><span class="line">	&lt;!ELEMENT poem (author,title,content)&gt;</span><br><span class="line">	&lt;!ELEMENT author (#PCDATA)&gt;</span><br><span class="line">	&lt;!ELEMENT title (#PCDATA)&gt;</span><br><span class="line">	&lt;!ELEMENT content (#PCDATA)&gt;</span><br><span class="line">]&gt;</span><br></pre></td></tr></table></figure></p>
<p>xml文件内容：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version="1.0"?&gt;</span><br><span class="line"><span class="meta">&lt;!DOCTYPE poem SYSTEM "poem.dtd"</span></span><br><span class="line"><span class="meta">&lt;poem&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">author</span>&gt;</span>作者<span class="tag">&lt;/<span class="name">author</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">title</span>&gt;</span>题目<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">content</span>&gt;</span>内容<span class="tag">&lt;/<span class="name">content</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">poem</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p><span id="1.1.3"></span></p>
<h5 id="内外结合的DTD"><a href="#内外结合的DTD" class="headerlink" title="内外结合的DTD"></a>内外结合的DTD</h5><p>内外结合很容易理解了就是说在xml文件内部有dtd的定义，在xml文件外部也有dtd定义文件，格式如下：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE 根元素 SYSTEM "DTD文件路径" [定义内容]&gt;</span></span><br></pre></td></tr></table></figure>
<p><span id="1.2"></span></p>
<h4 id="ELEMENT语法"><a href="#ELEMENT语法" class="headerlink" title="ELEMENT语法"></a>ELEMENT语法</h4><p><span id="1.2.1"></span></p>
<h5 id="元素定义"><a href="#元素定义" class="headerlink" title="元素定义"></a>元素定义</h5><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">!ELEMENT</span> 元素名称 元素类型&gt;</span></span><br></pre></td></tr></table></figure>
<p><span id="1.2.2"></span></p>
<h5 id="元素类型"><a href="#元素类型" class="headerlink" title="元素类型"></a>元素类型</h5><ol>
<li><p>EMPTY: 该元素不能包含子元素和文本，但可以有属性（空元素）</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">!ELEMENT</span> <span class="attr">TEST</span> <span class="attr">EMPTY</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">TEST</span>&gt;</span><span class="tag">&lt;/<span class="name">TEST</span>&gt;</span> 正确</span><br><span class="line"><span class="tag">&lt;<span class="name">TEST</span> <span class="attr">test</span>=<span class="string">"test"</span>&gt;</span><span class="tag">&lt;<span class="name">TEST</span>/&gt;</span><span class="tag">&lt;/<span class="name">TEST</span>&gt;</span> 错误，不能包含子元素</span><br><span class="line"><span class="tag">&lt;<span class="name">TEST</span>&gt;</span>TEST<span class="tag">&lt;/<span class="name">TEST</span>&gt;</span> 错误，不能包含文本</span><br></pre></td></tr></table></figure>
</li>
<li><p>#PCDATA: 可以包含任何数据，但是不能包含子元素 </p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">!ELEMENT</span> <span class="attr">TEST</span> (#<span class="attr">PCDATA</span>)&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">TEST</span>&gt;</span><span class="tag">&lt;/<span class="name">TEST</span>&gt;</span> 正确</span><br><span class="line"><span class="tag">&lt;<span class="name">TEST</span> <span class="attr">test</span>=<span class="string">"test"</span>&gt;</span><span class="tag">&lt;<span class="name">TEST</span>/&gt;</span><span class="tag">&lt;/<span class="name">TEST</span>&gt;</span> 错误，不能包含子元素</span><br><span class="line"><span class="tag">&lt;<span class="name">TEST</span>&gt;</span>TEST<span class="tag">&lt;/<span class="name">TEST</span>&gt;</span> 正确</span><br></pre></td></tr></table></figure>
</li>
<li><p>纯元素类型: 只能包含子元素，除子元素外不能有文本，在定义纯元素类型时，会有一些类似正则表达式的符号，如下：</p>
</li>
</ol>
<table>
<thead>
<tr>
<th style="text-align:center">符号</th>
<th style="text-align:center">用途</th>
<th style="text-align:center">示例</th>
<th style="text-align:center">示例说明</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">()</td>
<td style="text-align:center">用于元素分组</td>
<td style="text-align:center">(A&#124;B),(C&#124;D),E</td>
<td style="text-align:center">分成三组</td>
</tr>
<tr>
<td style="text-align:center">&#124;</td>
<td style="text-align:center">对象任选一个，或</td>
<td style="text-align:center">(A&#124;B&#124;C)</td>
<td style="text-align:center">表示A,B,C必须出现，二者至少选一</td>
</tr>
<tr>
<td style="text-align:center">,</td>
<td style="text-align:center">对象必须按照指定顺序出现</td>
<td style="text-align:center">(A,B,C)</td>
<td style="text-align:center">表示A,B,C必须出现，并且按此顺序</td>
</tr>
<tr>
<td style="text-align:center">*</td>
<td style="text-align:center">允许对象出现0到多次</td>
<td style="text-align:center">(A*)</td>
<td style="text-align:center">A可以出现0到多次</td>
</tr>
<tr>
<td style="text-align:center">?</td>
<td style="text-align:center">允许对象出现0到1次</td>
<td style="text-align:center">(A?)</td>
<td style="text-align:center">A可以出现0到1次</td>
</tr>
<tr>
<td style="text-align:center">+</td>
<td style="text-align:center">允许对象出现1到多次</td>
<td style="text-align:center">(A+)</td>
<td style="text-align:center">A可以出现1到多次</td>
</tr>
</tbody>
</table>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">!ELEMENT</span> <span class="attr">TEST</span> (<span class="attr">T</span>+, <span class="attr">P</span>*)&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">TEST</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">T</span> <span class="attr">t</span>=<span class="string">"t"</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">P</span> <span class="attr">P</span>=<span class="string">"P"</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">TEST</span>&gt;</span></span><br></pre></td></tr></table></figure>
<ol start="4">
<li>ANY: 可以包含任何在DTD中定义的内容，这个就不举例子了，xml可以任意书写，只要是DTD中定义的</li>
</ol>
<p><span id="1.2.3"></span></p>
<h5 id="属性语法"><a href="#属性语法" class="headerlink" title="属性语法"></a>属性语法</h5><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">!ATTLIST</span> 元素名称 </span></span><br><span class="line"><span class="tag">属性名称 属性类型 属性特点</span></span><br><span class="line"><span class="tag"><span class="attr">...</span></span></span><br><span class="line"><span class="tag">&gt;</span></span><br></pre></td></tr></table></figure>
<p><span id="1.2.4"></span></p>
<h5 id="属性类型"><a href="#属性类型" class="headerlink" title="属性类型"></a>属性类型</h5><p>属性类型有如下类型：</p>
<ul>
<li>CDATA: 表示属性可以是任何字符串</li>
<li>ID: 表明该属性的取值必须是唯一的</li>
<li>IDREF: IDREF是指它的值要指向文档当中其它地方声明的ID</li>
<li>IDREFS: IDREFS同IDREF，但是可以具有由空格分开的多个引用</li>
<li>Enumerated: 预先定义了一些值，属性的值必须在所列出的值的范围内</li>
</ul>
<p><strong>示例：</strong></p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- CDATA --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">!ATTLIST</span> <span class="attr">MAN</span> <span class="attr">NAME</span> <span class="attr">CDATA</span> #<span class="attr">REQUIRED</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">MAN</span> <span class="attr">NAME</span>=<span class="string">"任意字符"</span>&gt;</span><span class="tag">&lt;/<span class="name">MAN</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- ID --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">!ATTLIST</span> <span class="attr">MAN</span> <span class="attr">NAME</span> <span class="attr">ID</span> #<span class="attr">REQUIRED</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">MAN</span> <span class="attr">NAME</span>=<span class="string">"唯一名称"</span>&gt;</span><span class="tag">&lt;/<span class="name">MAN</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- IDREF/IDREFS --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">!ATTLIST</span> <span class="attr">MAN</span> </span></span><br><span class="line"><span class="tag"><span class="attr">NAME</span> <span class="attr">ID</span> #<span class="attr">REQUIRED</span></span></span><br><span class="line"><span class="tag"><span class="attr">FATHER</span> <span class="attr">IDREF</span> #<span class="attr">REQUIRED</span></span></span><br><span class="line"><span class="tag"><span class="attr">PARENT</span> <span class="attr">IDREFS</span> #<span class="attr">REQUIRED</span></span></span><br><span class="line"><span class="tag">&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">MAN</span> <span class="attr">NAME</span>=<span class="string">"唯一名称"</span> <span class="attr">FATHER</span>=<span class="string">"爸爸"</span> <span class="attr">PARENT</span>=<span class="string">"爸爸 妈妈"</span>&gt;</span><span class="tag">&lt;/<span class="name">MAN</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- Enumerated --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">!ATTLIST</span> <span class="attr">PERSON</span> <span class="attr">SEX</span> (<span class="attr">MAN</span>|<span class="attr">WOMEN</span>) #<span class="attr">REQUIRED</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">PERSON</span> <span class="attr">SEX</span>=<span class="string">"MAN"</span>&gt;</span><span class="tag">&lt;/<span class="name">PERSON</span>&gt;</span></span><br></pre></td></tr></table></figure>
<blockquote>
<p>PCDATA与CDATA区别：<br>CDATA是指CDATA就是指字符串，而PCDATA可以是字符串、子元素、字符串和子元素</p>
</blockquote>
<p>属性特点有如下特点：</p>
<ul>
<li>#REQUIRED: 表示元素的所有的实例都必须有该属性的值（NOT NULL）</li>
<li>#IMPLIED: 这就表示该属性的值是可以被忽略的。</li>
<li>#FIXED [VALUE]: 元素中该属性的值必须为指定的固定值。</li>
<li>Default [VALUE]: 为属性提供一个默认的值。</li>
</ul>
<p><strong>示例：</strong><br><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- #REQUIRED --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">!ATTLIST</span> <span class="attr">MAN</span> <span class="attr">NAME</span> <span class="attr">CDATA</span> #<span class="attr">REQUIRED</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- #IMPLIED --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">!ATTLIST</span> <span class="attr">MAN</span> <span class="attr">NAME</span> <span class="attr">CDATA</span> #<span class="attr">IMPLIED</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- #FIXED --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">!ATTLIST</span> <span class="attr">MAN</span> <span class="attr">NAME</span> <span class="attr">CDATA</span> #<span class="attr">FIXED</span> "<span class="attr">bob</span>"&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- Default --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">!ATTLIST</span> <span class="attr">MAN</span> <span class="attr">NAME</span> <span class="attr">CDATA</span> "<span class="attr">bob</span>"&gt;</span></span><br></pre></td></tr></table></figure></p>
<p><span id="1.2.5"></span></p>
<h5 id="实体"><a href="#实体" class="headerlink" title="实体"></a>实体</h5><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">!ENTITY</span> 实体名称 "实体值"&gt;</span></span><br></pre></td></tr></table></figure>
<p>实体可以理解为编程语言中的常量，可以在DTD文件中定义，然后在xml文件中进行引用，示例如下：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">!ENTITY</span> <span class="attr">MAN</span> "<span class="attr">BOB</span>"&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">PERSON</span>&gt;</span>&amp;MAN;<span class="tag">&lt;/<span class="name">PERSON</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p><span id="2"></span></p>
<h3 id="XSD语法"><a href="#XSD语法" class="headerlink" title="XSD语法"></a>XSD语法</h3><p><span id="2.1"></span></p>
<h5 id="Schema根元素语法"><a href="#Schema根元素语法" class="headerlink" title="Schema根元素语法"></a>Schema根元素语法</h5><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">xs:schema</span> <span class="attr">xmlns:xs</span>=<span class="string">"http://www.w3.org/2001/XMLSchema"</span></span></span><br><span class="line"><span class="tag"><span class="attr">targetNamespace</span>=<span class="string">"http://mynamespace/myschema"</span></span></span><br><span class="line"><span class="tag"><span class="attr">elementFormDefault</span>=<span class="string">"unqualified"</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- 实际内容 --&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">xs:schema</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>在XSD中必须定义一个且只能定义一个schema跟元素，根元素包括模式的约束、xml模式命名空间定义，其它命名空间的定义、版本信息、语言信息和其它一些属性</p>
<ul>
<li>xmlns:xs声明命名空间，用于构造schema的元素和数据类型都来自于此</li>
<li>targetNamespace声明自定义命名空间，自定义元素和数据类型属于此命名空间</li>
<li>elementFormDefault表明目标命名空间不一定遵循本Schema</li>
</ul>
<p><span id="2.2"></span></p>
<h5 id="基本数据类型"><a href="#基本数据类型" class="headerlink" title="基本数据类型"></a>基本数据类型</h5><p>基本类型是Schema的基本组成，可以利用基本数据类型定义属性或者创建自定义类型，如下：</p>
<table>
<thead>
<tr>
<th style="text-align:center">类型</th>
<th style="text-align:center">解释</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">boolean</td>
<td style="text-align:center">可以是1（true）或者0（false）</td>
</tr>
<tr>
<td style="text-align:center">dateTime</td>
<td style="text-align:center">表示时间的部分可选，格式：CCYY-MM-DDThh:mm:ss，例如：2019-6-18T14:32:12</td>
</tr>
<tr>
<td style="text-align:center">decimal</td>
<td style="text-align:center">表示任意精度的十进制数字</td>
</tr>
<tr>
<td style="text-align:center">string</td>
<td style="text-align:center">字符数据</td>
</tr>
<tr>
<td style="text-align:center">int</td>
<td style="text-align:center">表示从-2,147,483,648到2,147,483,648之间一个整数，4个字节</td>
</tr>
<tr>
<td style="text-align:center">nonNegativeInteger</td>
<td style="text-align:center">表示大于或者等于0的一个整数</td>
</tr>
<tr>
<td style="text-align:center">nonPositiveInteger</td>
<td style="text-align:center">表示小于或者等于0的一个整数</td>
</tr>
<tr>
<td style="text-align:center">short</td>
<td style="text-align:center">表示从-32768到32767之间的一个整数，2个字节</td>
</tr>
</tbody>
</table>
<p><span id="2.3"></span></p>
<h5 id="数据约束"><a href="#数据约束" class="headerlink" title="数据约束"></a>数据约束</h5><p>Schema虽然提供了一些内置的数据类型，但是利用数据类型限制数据并非能够完全满足，因此定义了一些对数据的约束，如下</p>
<table>
<thead>
<tr>
<th style="text-align:center">约束</th>
<th style="text-align:center">解释</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">enumeration</td>
<td style="text-align:center">用空格分开的一组指定的数值。它把数据类型约束为指定的值</td>
</tr>
<tr>
<td style="text-align:center">fractionDigit</td>
<td style="text-align:center">指定小数点后的最大位数</td>
</tr>
<tr>
<td style="text-align:center">length</td>
<td style="text-align:center">长度单位</td>
</tr>
<tr>
<td style="text-align:center">minExclusive</td>
<td style="text-align:center">下限值，所有的值都必须大于该值</td>
</tr>
<tr>
<td style="text-align:center">maxExclusive</td>
<td style="text-align:center">上限值，所有的值都应该小于该值</td>
</tr>
<tr>
<td style="text-align:center">minLength</td>
<td style="text-align:center">长度单位的最小个数</td>
</tr>
<tr>
<td style="text-align:center">maxLength</td>
<td style="text-align:center">长度单位的最大数</td>
</tr>
<tr>
<td style="text-align:center">minInclusive</td>
<td style="text-align:center">最小值，所有的值都应该大于或者等于该值</td>
</tr>
<tr>
<td style="text-align:center">maxInclusive</td>
<td style="text-align:center">最大值，所有的值都应该小于或者等于该值</td>
</tr>
<tr>
<td style="text-align:center">pattern</td>
<td style="text-align:center">数据类型的值必须匹配的指定模式，pattern值必须是一个正则表达式</td>
</tr>
<tr>
<td style="text-align:center">totalDigits</td>
<td style="text-align:center">指定小数最大位数的值</td>
</tr>
<tr>
<td style="text-align:center">whiteSpace</td>
<td style="text-align:center">其值为：preserve（值中的空格不能改变），replace（所有的制表符、换行符和回车符都用空格代替），collapse（执行replace，删除相邻的、结尾处和开头处的空格）</td>
</tr>
</tbody>
</table>
<p>应用上述的约束，就要利用元素restriction。这个元素中有2个属性：id属性是模式文档中restriction元素的唯一标识符，base属性设置为一个内置的XSD数据类型或者现有的简单类型定义，他是一种被限制的类型</p>
<p>示例：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 表示字符类型长度限制在4-10字符 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">xsd:restriction</span> <span class="attr">base</span>=<span class="string">"xsd:string"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">xsd:minLength</span> <span class="attr">value</span>=<span class="string">"4"</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">xsd:maxLength</span> <span class="attr">value</span>=<span class="string">"10"</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">xsd:restriction</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- 表示字符类型只能为一下三个值 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">xsd:restriction</span> <span class="attr">base</span>=<span class="string">”xsd:string”</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">xsd:enumeration</span> <span class="attr">value</span>=<span class="string">”FistValue”/</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">xsd:enumeration</span> <span class="attr">value</span>=<span class="string">”SecondValue”/</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">xsd:enumeration</span> <span class="attr">value</span>=<span class="string">”ThirdValue”/</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">xsd:restriction</span>&gt;</span></span><br></pre></td></tr></table></figure>
<blockquote>
<p>restriction用于定义简单类型或复杂类型，单独不确定是否能够使用</p>
</blockquote>
<p><span id="2.4"></span></p>
<h5 id="元素"><a href="#元素" class="headerlink" title="元素"></a>元素</h5><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">xsd:element</span> <span class="attr">name</span>=<span class="string">”user”</span> <span class="attr">type</span>=<span class="string">”xsd:string”/</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>元素定义这个是Schema的核心，其实总体理解来说Scheme的元素定义可以理解为对Xml元素的一种描述，也就是说Scheme的一个元素的定义就对应xml的一个元素，其中name是元素名称，type是元素类型，可以是Schema的内置类型也可以是自定义类型。</p>
<p><span id="2.5"></span></p>
<h5 id="默认值和固定值"><a href="#默认值和固定值" class="headerlink" title="默认值和固定值"></a>默认值和固定值</h5><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- 默认值 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">xsd:element</span> <span class="attr">name</span>=<span class="string">”city”</span> <span class="attr">type</span>=<span class="string">”xsd:string”</span> <span class="attr">default</span>=<span class="string">”beijing”</span> /&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- 固定值 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">xsd:element</span> <span class="attr">name</span>=<span class="string">"school"</span> <span class="attr">type</span>=<span class="string">"xsd:string"</span> <span class="attr">fixed</span>=<span class="string">"qinghua"</span></span></span><br></pre></td></tr></table></figure>
<p>默认值为默认值，固定值不允许改变</p>
<p><span id="2.6"></span></p>
<h5 id="组合器"><a href="#组合器" class="headerlink" title="组合器"></a>组合器</h5><p><strong>sequence组合器</strong></p>
<p>sequence组合器，定义了一列元素必须按照模式中指定的顺序显示（如果是可选的，也可以不显示）。语法如下：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">xsd:element</span> <span class="attr">name</span>=<span class="string">”name”</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">xsd:complexType</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">xsd:sequence</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">xsd:element</span> <span class="attr">name</span>=<span class="string">”first”</span> <span class="attr">type</span>=<span class="string">”xsd:string”</span> /&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">xsd:element</span> <span class="attr">name</span>=<span class="string">”middle”</span> <span class="attr">type</span>=<span class="string">”xsd:string”</span> /&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">xsd:element</span> <span class="attr">name</span>=<span class="string">”last”</span> <span class="attr">type</span>=<span class="string">”xsd:string”</span> /&gt;</span></span><br><span class="line">       <span class="tag">&lt;/<span class="name">xsd:sequence</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">xsd:complexType</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">xsd:element</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p><strong>all组合器</strong></p>
<p>all组合器，允许所定义的元素可以按照任意顺序显示，all元素的子元素在默认情况下是必须的，而且每次最多显示一次，语法如下：<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">xsd:element</span> <span class="attr">name</span>=<span class="string">”name”</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">xsd:complexType</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">xsd:all</span> <span class="attr">minOccurs</span>=<span class="string">”0”</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">xsd:element</span> <span class="attr">name</span>=<span class="string">”first”</span> <span class="attr">type</span>=<span class="string">”xsd:string”</span> /&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">xsd:element</span> <span class="attr">name</span>=<span class="string">”middle”</span> <span class="attr">type</span>=<span class="string">”xsd:string”</span> /&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">xsd:element</span> <span class="attr">name</span>=<span class="string">”last”</span> <span class="attr">type</span>=<span class="string">”xsd:string”</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">xsd:all</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">xsd:complexType</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">xsd:element</span>&gt;</span></span><br></pre></td></tr></table></figure></p>
<p><strong>choice组合器</strong></p>
<p>choice组合器，允许指定多组声明中的一个，用于互斥情况。语法如下:</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">xsd:element</span> <span class="attr">name</span>=<span class="string">”name”</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">xsd:complexType</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">xsd:choice</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">xsd:element</span> <span class="attr">name</span>=<span class="string">”first”</span> <span class="attr">type</span>=<span class="string">”xsd:string”</span> /&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">xsd:element</span> <span class="attr">name</span>=<span class="string">”middle”</span> <span class="attr">type</span>=<span class="string">”xsd:string”</span> /&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">xsd:element</span> <span class="attr">name</span>=<span class="string">”last”</span> <span class="attr">type</span>=<span class="string">”xsd:string”</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">xsd:choice</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">xsd:complexType</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">xsd:element</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p><span id="2.7"></span></p>
<h5 id="引用和替代"><a href="#引用和替代" class="headerlink" title="引用和替代"></a>引用和替代</h5><p>ref关键字，引用的存在就是为了避免在schema定义中重复定义同一个元素，语法如下：<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">xsd:element</span> <span class="attr">name</span>=<span class="string">”user”</span> <span class="attr">type</span>=<span class="string">”xsd:string”</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">xsd:element</span> <span class="attr">name</span>=<span class="string">”name”</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">xsd:complexType</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">xsd:sequence</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">xsd:element</span> <span class="attr">ref</span>=<span class="string">”user”</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">xsd:sequence</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">xsd:complexType</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">xsd:element</span>&gt;</span></span><br></pre></td></tr></table></figure></p>
<p>替代就是说可以利用另外的元素名称来替换指定的元素名称<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">xsd:element</span> <span class="attr">name</span>=<span class="string">”customer”</span> <span class="attr">type</span>=<span class="string">”xsd:string”</span> <span class="attr">substitutionGroup</span>=<span class="string">”user”</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">xsd:element</span> <span class="attr">name</span>=<span class="string">”user”</span> <span class="attr">type</span>=<span class="string">”xsd:string”</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">xsd:element</span> <span class="attr">name</span>=<span class="string">”name”</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">xsd:complexType</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">xsd:sequence</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">xsd:element</span> <span class="attr">ref</span>=<span class="string">”user”</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">xsd:sequence</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">xsd:complexType</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">xsd:element</span>&gt;</span></span><br></pre></td></tr></table></figure></p>
<p>合法xml元素定义：<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">customer</span>&gt;</span>string<span class="tag">&lt;/<span class="name">customer</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br></pre></td></tr></table></figure></p>
<p><span id="2.8"></span></p>
<h5 id="简单类型"><a href="#简单类型" class="headerlink" title="简单类型"></a>简单类型</h5><p>简单类型是对一个节点的可能可以进一步限制的自定义数据类型，创建简单类型需要利用simpleType元素，定义示例如下：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 表示该元素的文本长度范围是4~8 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">xsd:simpleType</span> <span class="attr">name</span>=<span class="string">”personsName”</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">xsd:restriction</span> <span class="attr">base</span>=<span class="string">”xsd:string”</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">xsd:minLength</span> <span class="attr">value</span>=<span class="string">”4”</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">xsd:maxLength</span> <span class="attr">value</span>=<span class="string">”8”</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">xsd:restriction</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">xsd:simpleType</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">xsd:element</span> <span class="attr">name</span>=<span class="string">”first”</span> <span class="attr">type</span>=<span class="string">”personsName”</span> /&gt;</span></span><br></pre></td></tr></table></figure>
<p><span id="2.9"></span></p>
<h5 id="复杂类型"><a href="#复杂类型" class="headerlink" title="复杂类型"></a>复杂类型</h5><p>复杂类型的定义必须使用complexType元素，在这里可以包含属性和元素。在复杂类型的使用中，主要是complexType和simpleType配合使用，示例如下：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">xsd:element</span> <span class="attr">name</span>=<span class="string">"name"</span> <span class="attr">type</span>=<span class="string">"FullName"</span> /&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">xsd:complexType</span> <span class="attr">name</span>=<span class="string">"FullName"</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">xsd:sequence</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">xsd:element</span> <span class="attr">name</span>=<span class="string">"first"</span> <span class="attr">type</span>=<span class="string">"PersonsFirstname"</span> <span class="attr">minOccurs</span>=<span class="string">"0"</span> <span class="attr">maxOccurs</span>=<span class="string">"1"</span> <span class="attr">default</span>=<span class="string">"John"</span> /&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">xsd:element</span> <span class="attr">name</span>=<span class="string">"middle"</span> <span class="attr">type</span>=<span class="string">"xsd:string"</span> <span class="attr">minOccurs</span>=<span class="string">"0"</span> <span class="attr">maxOccurs</span>=<span class="string">"unbounded"</span> <span class="attr">nillable</span>=<span class="string">"true"</span> /&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">xsd:element</span> <span class="attr">name</span>=<span class="string">"last"</span> <span class="attr">type</span>=<span class="string">"xsd:string"</span> <span class="attr">minOccurs</span>=<span class="string">"1"</span> <span class="attr">maxOccurs</span>=<span class="string">"1"</span> <span class="attr">default</span>=<span class="string">"Doe"</span> /&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">xsd:sequence</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">xsd:attribute</span> <span class="attr">name</span>=<span class="string">"title"</span> <span class="attr">type</span>=<span class="string">"PersonsTitle"</span> <span class="attr">default</span>=<span class="string">"Mr."</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">xsd:complexType</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">xsd:simpleType</span> <span class="attr">name</span>=<span class="string">"PersonsFirstname"</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">xsd:restriction</span> <span class="attr">base</span>=<span class="string">"xsd:string"</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">xsd:minLength</span> <span class="attr">value</span>=<span class="string">"4"</span> /&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">xsd:maxLength</span> <span class="attr">value</span>=<span class="string">"10"</span> /&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">xsd:restriction</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">xsd:simpleType</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">xsd:simpleType</span> <span class="attr">name</span>=<span class="string">"PersonsTitle"</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">xsd:restriction</span> <span class="attr">base</span>=<span class="string">"xsd:string"</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">xsd:enumeration</span> <span class="attr">value</span>=<span class="string">"Mr."</span> /&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">xsd:enumeration</span> <span class="attr">value</span>=<span class="string">"Mrs."</span> /&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">xsd:enumeration</span> <span class="attr">value</span>=<span class="string">"Miss."</span> /&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">xsd:restriction</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">xsd:simpleType</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>在看上边复杂类型FullName的定义，可以看出是对一个元素做出了很复杂的描述，比如必须按顺序显示三个子元素，子元素first必须是PersonsFirstname的简单类型，同时具备属性title，属性默认值为”Mr.”，并且值仅为枚举的几个。</p>
<p><span id="2.10"></span></p>
<h5 id="属性定义"><a href="#属性定义" class="headerlink" title="属性定义"></a>属性定义</h5><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">xsd:attribute</span> <span class="attr">name</span>=<span class="string">”age”</span> <span class="attr">type</span>=<span class="string">”xsd:integer”/</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>该语句定义了一个名为age的属性，它的值必须是一个整数。把它添加到模式中时，它必须时schema元素、complexType元素或者attributeGroup元素的子元素。</p>
<p><span id="2.11"></span></p>
<h5 id="分组和属性"><a href="#分组和属性" class="headerlink" title="分组和属性"></a>分组和属性</h5><p>在为定义XML文档而创建的一些更为复杂的定义中，会有一些元素集、属性集的组合，这是我们就使用了分组的概念。分组定义中使用的是group元素，示例如下：<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">xsd:group</span> <span class="attr">name</span>=<span class="string">”CityChoice”</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">xsd:choice</span>&gt;</span></span><br><span class="line">	    <span class="tag">&lt;<span class="name">xsd:element</span> <span class="attr">name</span>=<span class="string">”</span> <span class="attr">Beijing</span> ” <span class="attr">type</span>=<span class="string">”xsd:string”</span> /&gt;</span></span><br><span class="line">	    <span class="tag">&lt;<span class="name">xsd:element</span> <span class="attr">name</span>=<span class="string">”</span> <span class="attr">Shanghai</span> ” <span class="attr">type</span>=<span class="string">”xsd:string”</span> /&gt;</span></span><br><span class="line">	    <span class="tag">&lt;<span class="name">xsd:element</span> <span class="attr">name</span>=<span class="string">”Xian”</span> <span class="attr">type</span>=<span class="string">”xsd:string”</span> /&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">xsd:choice</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">xsd:group</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">xsd:element</span> <span class="attr">name</span>=<span class="string">”City”</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">xsd</span> ”<span class="attr">group</span> <span class="attr">ref</span>=<span class="string">”CityChoice”</span> <span class="attr">minOccurs</span>=<span class="string">”1”</span> <span class="attr">maxOccurs</span>=<span class="string">”1”</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">xsd:element</span>&gt;</span></span><br></pre></td></tr></table></figure></p>
<p>对属性的分组，应该使用attributeGroup元素，示例如下：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">xsd:attributeGroup</span> <span class="attr">name</span>=<span class="string">”contactAttribs”</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">xsd:attribute</span> <span class="attr">name</span>=<span class="string">”city”</span> <span class="attr">type</span>=<span class="string">”xsd:string”</span> /&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">xsd:attribute</span> <span class="attr">name</span>=<span class="string">”country”</span> <span class="attr">type</span>=<span class="string">”xsd:string”</span> /&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">xsd:attribute</span> <span class="attr">name</span>=<span class="string">”age”</span> <span class="attr">type</span>=<span class="string">”xsd:string”</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">xsd:attributeGroup</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">xsd:element</span> <span class="attr">name</span>=<span class="string">”contact”</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">xsd:complexType</span>&gt;</span></span><br><span class="line">	    <span class="tag">&lt;<span class="name">xsd:attributeGroup</span> <span class="attr">ref</span>=<span class="string">”contactAttribs”</span> /&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">xsd:complexType</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">xsd:element</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p><span id="2.12"></span></p>
<h5 id="内容模型"><a href="#内容模型" class="headerlink" title="内容模型"></a>内容模型</h5><p><strong>any</strong></p>
<p>当在XML中声明元素时any是默认的内容模型，该模型可以包含文本、元素和空格。如果允许添加元素的内容，且无需屋里修改模式文件，就可以使用该模型，示例如下：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">xsd:element</span> <span class="attr">name</span>=<span class="string">”name”</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">xsd:complexType</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">xsd:sequence</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">xsd:element</span> <span class="attr">name</span>=<span class="string">”first”</span> <span class="attr">type</span>=<span class="string">”xsd:string”</span> /&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">xsd:element</span> <span class="attr">name</span>=<span class="string">”middle”</span> <span class="attr">type</span>=<span class="string">”OtherNames”</span> /&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">xsd:element</span> <span class="attr">name</span>=<span class="string">”last”</span> <span class="attr">type</span>=<span class="string">”xsd:string”</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">xsd:sequence</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">xsd:complexType</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">xsd:element</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">xsd:complexType</span> <span class="attr">name</span>=<span class="string">”OtherNames”</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">xsd:sequence</span>&gt;</span></span><br><span class="line">    	<span class="tag">&lt;<span class="name">xsd:any</span> <span class="attr">namespace</span>=<span class="string">”##any”</span> <span class="attr">processContents</span>=<span class="string">”lax”</span> <span class="attr">minOccurs</span>=<span class="string">”0”</span> <span class="attr">maxOccurs</span>=<span class="string">”unbounded”</span> /&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">xsd:sequence</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">xsd:complexType</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>namespace属性允许的值为：</p>
<table>
<thead>
<tr>
<th style="text-align:center">符号</th>
<th style="text-align:center">解释</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">##any</td>
<td style="text-align:center">元素可以来自任何命名空间</td>
</tr>
<tr>
<td style="text-align:center">##other</td>
<td style="text-align:center">元素可以来自除了该元素的父元素所在的目标命名空间之外的命名空间</td>
</tr>
<tr>
<td style="text-align:center">##local</td>
<td style="text-align:center">元素不受命名空间的限制</td>
</tr>
<tr>
<td style="text-align:center">##targetNamespace</td>
<td style="text-align:center">元素来自父元素的目标命名空间</td>
</tr>
</tbody>
</table>
<p>processContents属性说明对这里所创建的元素进行验证时所执行的操作，取值有如下3种：</p>
<ul>
<li>strict:标明XML处理器必须获得和那些命名空间相关联的模式，并验证元素和属性</li>
<li>lax: 与strict相似，只是如果处理器找不到模式文档，也不会出现错误</li>
<li>skip: 不利用模式文档验证XML文档</li>
</ul>
<p><strong>empty</strong></p>
<p>mpty元素禁止把文本或者元素作为一个声明为空的元素的子元素，如果要保证该元素不包括子元素、文本甚至空格，就可以使用它。在XSD中时利用xsd:anyType类型来限定它的，这样就意味元素只能包含属性，例如：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">xsd:element</span> <span class="attr">name</span>=<span class="string">”contact”</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">xsd:complexType</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">xsd:complexContent</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">xsd:restriction</span> <span class="attr">base</span>=<span class="string">”xsd:anyType”</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">xsd:attribute</span> <span class="attr">name</span>=<span class="string">”age”</span> <span class="attr">type</span>=<span class="string">”xsd:integer”</span> /&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">xsd:restriction</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">xsd:complexContent</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">xsd:complexType</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">xsd:element</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>以上就是一个复杂类型，只允许有一个age属性。在例子里complexContent元素可以表示complexType的内容要进行扩充或者限制，在这里，我们对其内容进行限制，因此使用了restriction元素，如果扩成则使用exension元素。</p>
<p><strong>mixed</strong></p>
<p>最后一个内容模型就是mixed，它包含文本、内容和属性。在complexType元素上把mixed属性的值设为true，就一个声明一个mixed内容模型了。例如：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">xsd:element</span> <span class="attr">name</span>=<span class="string">”contact”</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">xsd:complexType</span> <span class="attr">mixed</span>=<span class="string">”true”</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">xsd:sequence</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">xsd:element</span> <span class="attr">name</span>=<span class="string">”first”</span> <span class="attr">type</span>=<span class="string">”xsd:string”/</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">xsd:sequence</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">xsd:complexType</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">xsd:element</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p><span id="3"></span></p>
<h3 id="Spring-XML验证"><a href="#Spring-XML验证" class="headerlink" title="Spring XML验证"></a>Spring XML验证</h3><p>此部分是Spring加载xml文档并且进行xsd验证进行的一下分析，此部分承接上一篇文章，先看下如下的时序图：</p>
<p><img src="/img/java/java-spring-xml-validate.jpg" alt="Spring xml验证"></p>
<p>如图所述：<br>1、<code>XmlBeanDefinitonReader</code>并未直接进行xml的读取，而是将读取的工作代理给了<code>DocumentLoader</code>，首先现获取的是<code>EntityResolver</code>，此处要说明一下<code>EntityResolver</code>的作用，何为<code>EntityResolver</code>? 如果SAX应用程序需要实现 自定义处理外部实体，则必须实现此接口并使用<code>setEntityResolver</code> 方法向SAX驱动器注册一个实例，对于解析一个XML, SAX首先读取该XML文档上的声明，根据声明去寻找相应的DTD/XSD定义的，以便对文档进行一个验证，但是存在网络问题时候，是无法下载的，因此<code>EntityResolver</code>的作用是项目本身就可以提供一个如何寻找DTD/XSD定义的方法，可以看下如下的代码(org.springframework.beans.factory.xml.DelegatingEntityResolver#resolveEntity)：<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> InputSource <span class="title">resolveEntity</span><span class="params">(String publicId, @Nullable String systemId)</span> <span class="keyword">throws</span> SAXException, IOException </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (systemId != <span class="keyword">null</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (systemId.endsWith(DTD_SUFFIX)) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">this</span>.dtdResolver.resolveEntity(publicId, systemId);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> (systemId.endsWith(XSD_SUFFIX)) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">this</span>.schemaResolver.resolveEntity(publicId, systemId);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>该函数接收两个参数：<code>publicId</code>:此字段的含义是模式定义文件的一个公开名称，<code>systemId</code>:一般是指该模式定义文件的url，看如下xsd/dtd定义：</p>
<p>看xsd如下定义：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xrnl version=”l.0” encoding=”UTF-8”?&gt;</span><br><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xrnlns</span>=<span class="string">"http://www.Springfrarnework.org/scherna/beans”</span></span></span><br><span class="line"><span class="tag"><span class="string">xrnlns :xsi=”http://www.w3.org/2001/XMLScherna-instance” xsi.schemaL。cation="</span><span class="attr">http:</span>//<span class="attr">www</span> <span class="attr">.</span> <span class="attr">Springframework.org</span>/<span class="attr">schema</span>/<span class="attr">beans</span> <span class="attr">http:</span>//<span class="attr">www.springframework.org</span>/<span class="attr">schema</span>/<span class="attr">beans</span>/<span class="attr">Spring-beans.xsd</span>" &gt;</span></span><br></pre></td></tr></table></figure>
<p>读取到的两个参数值如下：</p>
<ul>
<li>publicld: null</li>
<li>systemId: <a href="http://www.springfamework.org/schema/beans/Spring-beans.xsd" target="_blank" rel="noopener">http://www.springfamework.org/schema/beans/Spring-beans.xsd</a></li>
</ul>
<p>看dtd定义：<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xrnl version=”1.0” encoding=”UTF-8"?〉</span><br><span class="line">&lt;!DOCTYPE beans PUBLIC ”-//Spring//DTD BEAN 2.0//EN" "http://www.Springfrarnework.org/</span><br><span class="line">dtd/Spring-beans-2.0.dtd” &gt; </span><br><span class="line">&lt;beans&gt;</span><br><span class="line">&lt;/beans&gt;</span><br></pre></td></tr></table></figure></p>
<p>读取到的两个参数值如下：</p>
<ul>
<li>publicld: -//Spring//DTD BEAN 2.0//EN</li>
<li>systemId: <a href="http://www.Springfrarnework.org/" target="_blank" rel="noopener">http://www.Springfrarnework.org/</a><br>dtd/Spring-beans-2.0.dtd</li>
</ul>
<p>从以上的代码逻辑可以看到，是根据文件名称的后缀的不同采用不同的Resolver进行处理的，对于DTD文件采用<code>BeansDtdResolver</code>进行处理，对于XSD文件利用<code>PluggableSchemaResolver</code>进行处理，对于xsd文件默认从<code>META-INF/spring.schemas</code>该路径下进行加载。</p>
<p>2、 获取校验模式，代码如下:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">protected</span> <span class="keyword">int</span> <span class="title">getValidationModeForResource</span><span class="params">(Resource resource)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> validationModeToUse = getValidationMode();</span><br><span class="line">    <span class="keyword">if</span> (validationModeToUse != VALIDATION_AUTO) &#123;</span><br><span class="line">        <span class="keyword">return</span> validationModeToUse;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">int</span> detectedMode = detectValidationMode(resource);</span><br><span class="line">    <span class="keyword">if</span> (detectedMode != VALIDATION_AUTO) &#123;</span><br><span class="line">        <span class="keyword">return</span> detectedMode;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> VALIDATION_XSD;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>默认是自动检测的，但是会对当前的xml文件进行探测，对于判定是否为dtd文件的方式很简单，即是否以包含DOCTYPE，详情可以查看代码（org.springframework.util.xml.XmlValidationModeDetector#detectValidationMode）</p>
<p>3、创建<code>DocumentBuilderFactory</code>，代码如下：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">protected</span> DocumentBuilderFactory <span class="title">createDocumentBuilderFactory</span><span class="params">(<span class="keyword">int</span> validationMode, <span class="keyword">boolean</span> namespaceAware)</span></span></span><br><span class="line"><span class="function">            <span class="keyword">throws</span> ParserConfigurationException </span>&#123;</span><br><span class="line"></span><br><span class="line">    DocumentBuilderFactory factory = DocumentBuilderFactory.newInstance();</span><br><span class="line">    factory.setNamespaceAware(namespaceAware);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (validationMode != XmlValidationModeDetector.VALIDATION_NONE) &#123;</span><br><span class="line">        factory.setValidating(<span class="keyword">true</span>);</span><br><span class="line">        <span class="keyword">if</span> (validationMode == XmlValidationModeDetector.VALIDATION_XSD) &#123;</span><br><span class="line">            <span class="comment">// Enforce namespace aware for XSD...</span></span><br><span class="line">            factory.setNamespaceAware(<span class="keyword">true</span>);</span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                factory.setAttribute(SCHEMA_LANGUAGE_ATTRIBUTE, XSD_SCHEMA_LANGUAGE);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">catch</span> (IllegalArgumentException ex) &#123;</span><br><span class="line">                ParserConfigurationException pcex = <span class="keyword">new</span> ParserConfigurationException(</span><br><span class="line">                        <span class="string">"Unable to validate using XSD: Your JAXP provider ["</span> + factory +</span><br><span class="line">                        <span class="string">"] does not support XML Schema. Are you running on Java 1.4 with Apache Crimson? "</span> + <span class="string">"Upgrade to Apache Xerces (or Java 1.5) for full XSD support."</span>);</span><br><span class="line">                pcex.initCause(ex);</span><br><span class="line">                <span class="keyword">throw</span> pcex;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> factory;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>其中<code>factory.setValidating(true)</code>是开启xml验证，<code>factory.setNamespaceAware(true)</code>是对于xsd文件进行命名空间的验证</p>
<p><span id="4"></span></p>
<h3 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h3><ul>
<li><a href="https://www.cnblogs.com/joean/p/4982877.html" target="_blank" rel="noopener">XML Schema的基本语法(转)</a></li>
<li><a href="https://blog.csdn.net/zane3/article/details/63253281" target="_blank" rel="noopener">XML解释及验证机制</a></li>
</ul>

        </div>
        <footer class="article-footer">
            


    <div class="a2a_kit a2a_default_style">
    <a class="a2a_dd" href="https://www.addtoany.com/share">Share</a>
    <span class="a2a_divider"></span>
    <a class="a2a_button_facebook"></a>
    <a class="a2a_button_twitter"></a>
    <a class="a2a_button_google_plus"></a>
    <a class="a2a_button_pinterest"></a>
    <a class="a2a_button_tumblr"></a>
</div>
<script type="text/javascript" src="//static.addtoany.com/menu/page.js"></script>
<style>
    .a2a_menu {
        border-radius: 4px;
    }
    .a2a_menu a {
        margin: 2px 0;
        font-size: 14px;
        line-height: 16px;
        border-radius: 4px;
        color: inherit !important;
        font-family: 'Microsoft Yahei';
    }
    #a2apage_dropdown {
        margin: 10px 0;
    }
    .a2a_mini_services {
        padding: 10px;
    }
    a.a2a_i,
    i.a2a_i {
        width: 122px;
        line-height: 16px;
    }
    a.a2a_i .a2a_svg,
    a.a2a_more .a2a_svg {
        width: 16px;
        height: 16px;
        line-height: 16px;
        vertical-align: top;
        background-size: 16px;
    }
    a.a2a_i {
        border: none !important;
    }
    a.a2a_menu_show_more_less {
        margin: 0;
        padding: 10px 0;
        line-height: 16px;
    }
    .a2a_mini_services:after{content:".";display:block;height:0;clear:both;visibility:hidden}
    .a2a_mini_services{*+height:1%;}
</style>


        </footer>
    </div>
</article>

    <section id="comments">
    
        
    <div id="valine-thread"></div>

    
    </section>


                        </div>
                    </section>
                    <aside id="sidebar">
    <a class="sidebar-toggle" title="Expand Sidebar"><i class="toggle icon"></i></a>
    <div class="sidebar-top">
        <p>关注我 :</p>
        <ul class="social-links">
            
                
                <li>
                    <a class="social-tooltip" title="twitter" href="/" target="_blank">
                        <i class="icon fa fa-twitter"></i>
                    </a>
                </li>
                
            
                
                <li>
                    <a class="social-tooltip" title="facebook" href="/" target="_blank">
                        <i class="icon fa fa-facebook"></i>
                    </a>
                </li>
                
            
                
                <li>
                    <a class="social-tooltip" title="google-plus" href="/" target="_blank">
                        <i class="icon fa fa-google-plus"></i>
                    </a>
                </li>
                
            
                
                <li>
                    <a class="social-tooltip" title="github" href="https://github.com/ppoffice/hexo-theme-hueman" target="_blank">
                        <i class="icon fa fa-github"></i>
                    </a>
                </li>
                
            
                
                <li>
                    <a class="social-tooltip" title="weibo" href="/" target="_blank">
                        <i class="icon fa fa-weibo"></i>
                    </a>
                </li>
                
            
                
                <li>
                    <a class="social-tooltip" title="rss" href="/" target="_blank">
                        <i class="icon fa fa-rss"></i>
                    </a>
                </li>
                
            
        </ul>
    </div>
    
        
<nav id="article-nav">
    
        <a href="/2018/07/05/java-mybatis-paging-interceptor/" id="article-nav-newer" class="article-nav-link-wrap">
        <strong class="article-nav-caption">下一篇</strong>
        <p class="article-nav-title">
        
            基于Mybatis的注解式分页插件
        
        </p>
        <i class="icon fa fa-chevron-right" id="icon-chevron-right"></i>
    </a>
    
    
        <a href="/2018/06/23/java-spring-bean-load-summary/" id="article-nav-older" class="article-nav-link-wrap">
        <strong class="article-nav-caption">上一篇</strong>
        <p class="article-nav-title">【Spring源码】（三）Spring Bean加载概览</p>
        <i class="icon fa fa-chevron-left" id="icon-chevron-left"></i>
        </a>
    
</nav>

    
    <div class="widgets-container">
        
            
                

            
                
    <div class="widget-wrap">
        <h3 class="widget-title">最新文章</h3>
        <div class="widget">
            <ul id="recent-post" class="">
                
                    <li>
                        
                        <div class="item-thumbnail">
                            <a href="/2021/04/03/java-object-methods/" class="thumbnail">
    
    
        <span style="background-image:url(/img/java-logo.png)" alt="Object有几种方法" class="thumbnail-image"></span>
    
    
</a>

                        </div>
                        
                        <div class="item-inner">
                            <p class="item-category"></p>
                            <p class="item-title"><a href="/2021/04/03/java-object-methods/" class="title">Object有几种方法</a></p>
                            <p class="item-date"><time datetime="2021-04-03T12:55:40.000Z" itemprop="datePublished">2021-04-03</time></p>
                        </div>
                    </li>
                
                    <li>
                        
                        <div class="item-thumbnail">
                            <a href="/2021/04/03/redis-breakdown-slide-hotpot/" class="thumbnail">
    
    
        <span style="background-image:url(/img/cache/redis.jpeg)" alt="缓存击穿、穿透、雪崩、热点数据" class="thumbnail-image"></span>
    
    
</a>

                        </div>
                        
                        <div class="item-inner">
                            <p class="item-category"><a class="article-category-link" href="/categories/技术/">技术</a></p>
                            <p class="item-title"><a href="/2021/04/03/redis-breakdown-slide-hotpot/" class="title">缓存击穿、穿透、雪崩、热点数据</a></p>
                            <p class="item-date"><time datetime="2021-04-02T16:23:03.000Z" itemprop="datePublished">2021-04-03</time></p>
                        </div>
                    </li>
                
                    <li>
                        
                        <div class="item-thumbnail">
                            <a href="/2021/04/02/java-basics-equal-hashcode/" class="thumbnail">
    
    
        <span style="background-image:url(/img/java-logo.png)" alt="equals和hashCode" class="thumbnail-image"></span>
    
    
</a>

                        </div>
                        
                        <div class="item-inner">
                            <p class="item-category"><a class="article-category-link" href="/categories/技术/">技术</a></p>
                            <p class="item-title"><a href="/2021/04/02/java-basics-equal-hashcode/" class="title">equals和hashCode</a></p>
                            <p class="item-date"><time datetime="2021-04-02T15:12:14.000Z" itemprop="datePublished">2021-04-02</time></p>
                        </div>
                    </li>
                
                    <li>
                        
                        <div class="item-thumbnail">
                            <a href="/2019/02/21/java-threadlocal/" class="thumbnail">
    
    
        <span style="background-image:url(/img/java/java-concurrent.jpg)" alt="ThreadLocal详解" class="thumbnail-image"></span>
    
    
</a>

                        </div>
                        
                        <div class="item-inner">
                            <p class="item-category"><a class="article-category-link" href="/categories/技术/">技术</a></p>
                            <p class="item-title"><a href="/2019/02/21/java-threadlocal/" class="title">ThreadLocal详解</a></p>
                            <p class="item-date"><time datetime="2019-02-21T08:04:58.000Z" itemprop="datePublished">2019-02-21</time></p>
                        </div>
                    </li>
                
                    <li>
                        
                        <div class="item-thumbnail">
                            <a href="/2018/12/10/java-concurrenthashmap/" class="thumbnail">
    
    
        <span style="background-image:url(/img/java/java-concurrent.jpg)" alt="ConcurrentHashMap源码演进" class="thumbnail-image"></span>
    
    
</a>

                        </div>
                        
                        <div class="item-inner">
                            <p class="item-category"><a class="article-category-link" href="/categories/技术/">技术</a></p>
                            <p class="item-title"><a href="/2018/12/10/java-concurrenthashmap/" class="title">ConcurrentHashMap源码演进</a></p>
                            <p class="item-date"><time datetime="2018-12-09T16:28:17.000Z" itemprop="datePublished">2018-12-10</time></p>
                        </div>
                    </li>
                
            </ul>
        </div>
    </div>

            
                
    <div class="widget-wrap widget-list">
        <h3 class="widget-title">分类</h3>
        <div class="widget">
            <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/技术/">技术</a><span class="category-list-count">20</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/算法/">算法</a><span class="category-list-count">4</span></li></ul>
        </div>
    </div>


            
                
    <div class="widget-wrap widget-list">
        <h3 class="widget-title">归档</h3>
        <div class="widget">
            <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/04/">四月 2021</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/02/">二月 2019</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/12/">十二月 2018</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/11/">十一月 2018</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/08/">八月 2018</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/07/">七月 2018</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/06/">六月 2018</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/05/">五月 2018</a><span class="archive-list-count">6</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/03/">三月 2018</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/12/">十二月 2017</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/01/">一月 2017</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/12/">十二月 2016</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/11/">十一月 2016</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/08/">八月 2016</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/07/">七月 2016</a><span class="archive-list-count">1</span></li></ul>
        </div>
    </div>


            
                
    <div class="widget-wrap widget-list">
        <h3 class="widget-title">标签</h3>
        <div class="widget">
            <ul class="tag-list"><li class="tag-list-item"><a class="tag-list-link" href="/tags/Dubbo/">Dubbo</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Java/">Java</a><span class="tag-list-count">4</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/LeetCode/">LeetCode</a><span class="tag-list-count">4</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Maven/">Maven</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Mybatis/">Mybatis</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Mysql/">Mysql</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Nio/">Nio</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Shadowsocks/">Shadowsocks</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Spring/">Spring</a><span class="tag-list-count">4</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/redis/">redis</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/并发/">并发</a><span class="tag-list-count">6</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/设计模式/">设计模式</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/读书笔记/">读书笔记</a><span class="tag-list-count">4</span></li></ul>
        </div>
    </div>


            
                
    <div class="widget-wrap widget-float">
        <h3 class="widget-title">标签云</h3>
        <div class="widget tagcloud">
            <a href="/tags/Dubbo/" style="font-size: 13.33px;">Dubbo</a> <a href="/tags/Java/" style="font-size: 16.67px;">Java</a> <a href="/tags/LeetCode/" style="font-size: 16.67px;">LeetCode</a> <a href="/tags/Maven/" style="font-size: 10px;">Maven</a> <a href="/tags/Mybatis/" style="font-size: 10px;">Mybatis</a> <a href="/tags/Mysql/" style="font-size: 10px;">Mysql</a> <a href="/tags/Nio/" style="font-size: 10px;">Nio</a> <a href="/tags/Shadowsocks/" style="font-size: 10px;">Shadowsocks</a> <a href="/tags/Spring/" style="font-size: 16.67px;">Spring</a> <a href="/tags/redis/" style="font-size: 10px;">redis</a> <a href="/tags/并发/" style="font-size: 20px;">并发</a> <a href="/tags/设计模式/" style="font-size: 10px;">设计模式</a> <a href="/tags/读书笔记/" style="font-size: 16.67px;">读书笔记</a>
        </div>
    </div>


            
                
    <div class="widget-wrap widget-list">
        <h3 class="widget-title">链接</h3>
        <div class="widget">
            <ul>
                
            </ul>
        </div>
    </div>


            
        
    </div>
</aside>
                </div>
            </div>
        </div>
        <footer id="footer">
    <div class="container">
        <div class="container-inner">
            <a id="back-to-top" href="javascript:;"><i class="icon fa fa-angle-up"></i></a>
            <div class="credit">
                <h1 class="logo-wrap">
                    <a href="/" class="logo"></a>
                </h1>
                <p>&copy; 2021 Peachey</p>
                <p>Powered by <a href="//hexo.io/" target="_blank">Hexo</a>. Theme by <a href="//github.com/ppoffice" target="_blank">PPOffice</a></p>
            </div>
        </div>
    </div>
</footer>
        
    
    <script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script>
    <script src="//cdn.jsdelivr.net/gh/xcss/valine@v1.1.7-rc3/dist/Valine.min.js"></script>
    <script>
        new Valine({
            el: '#valine-thread' ,
            notify:false,
            verify:true,
            app_id: 'm643zV6fkatNCTYrsSGVp9t7-gzGzoHsz',
            app_key: 'D2IHXCDEAUsrUI29D0U4CvYD',
            placeholder: '可以发表下你的看法~'
        });
    </script>




    
        <script src="/libs/lightgallery/js/lightgallery.min.js"></script>
        <script src="/libs/lightgallery/js/lg-thumbnail.min.js"></script>
        <script src="/libs/lightgallery/js/lg-pager.min.js"></script>
        <script src="/libs/lightgallery/js/lg-autoplay.min.js"></script>
        <script src="/libs/lightgallery/js/lg-fullscreen.min.js"></script>
        <script src="/libs/lightgallery/js/lg-zoom.min.js"></script>
        <script src="/libs/lightgallery/js/lg-hash.min.js"></script>
        <script src="/libs/lightgallery/js/lg-share.min.js"></script>
        <script src="/libs/lightgallery/js/lg-video.min.js"></script>
    
    
        <script src="/libs/justified-gallery/jquery.justifiedGallery.min.js"></script>
    
    



<!-- Custom Scripts -->
<script src="/js/main.js"></script>

    </div>
</body>
</html>
